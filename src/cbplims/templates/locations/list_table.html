{% extends "settings/layout.html" %}
{% block adminbody %}

  <h2>Here are the locations</h2>
<div class="msg">{{msg}}</div>
{% if not locations %}
    <div class="msg"> You were at the last location </div>
{% else %}


<form method="POST" action="/location/state">
<div>
    <div style="float:left;">
      
      <input type="submit" name="method" value="Disable"/>
      <input type="submit" name="method" value="Enable"/>
    </div>
    <div style="float:right;">

    </div>
  </div>
<br>

<table id="loc_table" class="loc_table" border=1>   

    {% for r in range(1,dim.row+1) %}
       <tr id="r_{{r}}">
            {% for c in range(1,dim.col+1) %}
                {% set vars = {'con': 0}  %}
                {% for l in locations%}
                    {% if l.parent_row == r and  l.parent_col == c %}
                        <td id="c_{{c}}">
                            
                            <div class="cell">
                                 {% if l.is_active == true %}
                                        {{l.name}} 
                                    {% else %}
                                        <span class="notactive"> {{l.name}} </span>
                                    {% endif %}
                                
                                <input type="checkbox" name="location_id" value="{{l.id}}">
                            </div>
                            <div class="cell_forward"><a href="/location/{{l.id}}/list"> Forward </a></div>
                            <div class="cell_forward">
                                {% if l.my_rows > 0 or l.my_cols > 0 %}
                                    <a href="/location/{{l.id}}/matrix"> Add </a>
                                {% else %}
                                    <a href="/location/{{l.id}}/add"> Add </a>
                                {% endif %}
                            </div>
                            <div class="cell_forward">
                                <a href="/location/{{l.id}}/edit"> Edit </a>
                            </div>
                        </td>
                        {% if vars.update({'con': 1}) %}{%endif%}
                    {% endif %}
                {% endfor %}
                
                {% if vars.con == 0%}
                <td id="c_{{c}}"> <div class="cell"> <a href="/location/{{back}}/add?row={{r}}&col={{c}}"> Add </a> </div></td>
                {% endif %}
            {% endfor %}
       </tr>
    
    {% endfor %}

</table>
<input type="hidden" name="parent_id" value = {{back}}>
</form>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"> </script>
<script>
    $(document).ready(function() {

        $('#loc_table td').click(function() {
            var cellText = $(this).html();
            var cid = this.id;  
            var tid = $(this).closest('tr').attr('id'); 
            //alert(cid+"row "+ tid);
            
        });

});
    
</script>

{% endif %}

{% endblock %}